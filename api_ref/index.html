<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API reference - dataverse_utils</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API reference";
        var mkdocs_page_input_path = "api_ref.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> dataverse_utils
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../scripts/">Console utilities</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">API reference</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#dataverse_utils">dataverse_utils</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dataverse_utilsdataverse_utils">dataverse_utils.dataverse_utils</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#dvgeneraluploaderror-objects">DvGeneralUploadError Objects</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#md5error-objects">Md5Error Objects</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#make_tsv">make_tsv</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dump_tsv">dump_tsv</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#file_path">file_path</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#check_lock">check_lock</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#force_notab_unlock">force_notab_unlock</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#uningest_file">uningest_file</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#upload_file">upload_file</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#restrict_file">restrict_file</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#upload_from_tsv">upload_from_tsv</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dataverse_utilsldc">dataverse_utils.ldc</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#ldc-objects">Ldc Objects</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#__init__">__init__</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#ldcjson">ldcJson</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dryadjson">dryadJson</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dvjson">dvJson</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#embargo">embargo</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#filejson">fileJson</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#files">files</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#fetch_record">fetch_record</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#make_ldc_json">make_ldc_json</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#name_parser">name_parser</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#make_dryad_json">make_dryad_json</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#find_block_index">find_block_index</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#make_dv_json">make_dv_json</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#upload_metadata">upload_metadata</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dataverse_utilsdvdata">dataverse_utils.dvdata</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#study-objects">Study Objects</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#__init___1">__init__</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#file-objects">File Objects</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#__init___2">__init__</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#download_file">download_file</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#del_tempfile">del_tempfile</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#produce_digest">produce_digest</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#verify">verify</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../faq/">FAQ</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../windows/">Windows notes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../credits/">Credits</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">dataverse_utils</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>API reference</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p><a id="dataverse_utils"></a></p>
<h2 id="dataverse_utils">dataverse_utils<a class="headerlink" href="#dataverse_utils" title="Permanent link">&para;</a></h2>
<p>Generalized dataverse utilities. Note that
<code>import dataverse_utils</code> is the equivalent of
<code>import dataverse_utils.dataverse_utils</code></p>
<p><a id="dataverse_utils.dataverse_utils"></a></p>
<h2 id="dataverse_utilsdataverse_utils">dataverse_utils.dataverse_utils<a class="headerlink" href="#dataverse_utilsdataverse_utils" title="Permanent link">&para;</a></h2>
<p>A collection of Dataverse utilities for file and metadata
manipulation</p>
<p><a id="dataverse_utils.dataverse_utils.DvGeneralUploadError"></a></p>
<h3 id="dvgeneraluploaderror-objects">DvGeneralUploadError Objects<a class="headerlink" href="#dvgeneraluploaderror-objects" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">class DvGeneralUploadError(Exception)
</code></pre>
<p>Raised on non-200 URL response</p>
<p><a id="dataverse_utils.dataverse_utils.Md5Error"></a></p>
<h3 id="md5error-objects">Md5Error Objects<a class="headerlink" href="#md5error-objects" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">class Md5Error(Exception)
</code></pre>
<p>Raised on md5 mismatch</p>
<p><a id="dataverse_utils.dataverse_utils.make_tsv"></a></p>
<h5 id="make_tsv">make_tsv<a class="headerlink" href="#make_tsv" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def make_tsv(start_dir,
             in_list=None,
             def_tag='Data',
             inc_header=True,
             mime=False,
             quotype=csv.QUOTE_MINIMAL) -&gt; str
</code></pre>
<p>Recurses the tree for files and produces tsv output with
with headers &lsquo;file&rsquo;, &lsquo;description&rsquo;, &lsquo;tags&rsquo;.</p>
<p>The &lsquo;description&rsquo; is the filename without an extension.</p>
<p>Returns tsv as string.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>start_dir : str
  Path to start directory</p>
<p>in_list : list
  Input file list. Defaults to recursive walk of current directory.</p>
<p>def_tag : str
  Default Dataverse tag (eg, Data, Documentation, etc)
  Separate tags with a comma:
  eg. (&lsquo;Data, 2016&rsquo;)</p>
<p>inc_header : bool
  Include header row</p>
<p>mime : bool
  Include automatically determined mimetype</p>
<ul>
<li><code>quotype</code> - int
  integer value or csv quote type.
  Default = csv.QUOTE_MINIMAL
  Acceptable values:
  csv.QUOTE_MINIMAL / 0
  csv.QUOTE_ALL / 1
  csv.QUOTE_NONNUMERIC / 2
  csv.QUOTE_NONE / 3</li>
</ul>
<p><a id="dataverse_utils.dataverse_utils.dump_tsv"></a></p>
<h5 id="dump_tsv">dump_tsv<a class="headerlink" href="#dump_tsv" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def dump_tsv(start_dir, filename, in_list=None, **kwargs)
</code></pre>
<p>Dumps output of make_tsv manifest to a file.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>start_dir : str
  Path to start directory</p>
<p>in_list : list
  List of files for which to create manifest entries. Will
  default to recursive directory crawl</p>
<p>OPTIONAL KEYWORD ARGUMENTS</p>
<p>def_tag : str
  Default Dataverse tag (eg, Data, Documentation, etc)
  Separate tags with an easily splitable character:
  eg. (&lsquo;Data, 2016&rsquo;)
- <code>Default</code> - &lsquo;Data&rsquo;</p>
<p>inc_header : bool
  Include header for tsv.
  Default : True</p>
<ul>
<li><code>quotype</code> - int
  integer value or csv quote type.
  Default : csv.QUOTE_MINIMAL
  Acceptable values:
  csv.QUOTE_MINIMAL / 0
  csv.QUOTE_ALL / 1
  csv.QUOTE_NONNUMERIC / 2
  csv.QUOTE_NONE / 3</li>
</ul>
<p><a id="dataverse_utils.dataverse_utils.file_path"></a></p>
<h5 id="file_path">file_path<a class="headerlink" href="#file_path" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def file_path(fpath, trunc='') -&gt; str
</code></pre>
<p>Create relative file path from full path string</p>
<blockquote>
<blockquote>
<blockquote>
<p>file_path(&lsquo;/tmp/Data/2011/excelfile.xlsx&rsquo;, &lsquo;/tmp/&rsquo;)
&lsquo;Data/2011&rsquo;
file_path(&lsquo;/tmp/Data/2011/excelfile.xlsx&rsquo;, &lsquo;/tmp&rsquo;)
&lsquo;Data/2011&rsquo;</p>
</blockquote>
</blockquote>
</blockquote>
<hr />
<p><strong>Arguments</strong>:</p>
<p>fpath : str
  File location (ie, complete path)</p>
<p>trunc : str
  Leftmost portion of path to remove</p>
<p><a id="dataverse_utils.dataverse_utils.check_lock"></a></p>
<h5 id="check_lock">check_lock<a class="headerlink" href="#check_lock" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def check_lock(dv_url, study, apikey) -&gt; bool
</code></pre>
<p>Checks study lock status; returns True if locked.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>dvurl : str
  URL of Dataverse installation</p>
<ul>
<li><code>study</code> - str
  Persistent ID of study</li>
</ul>
<p>apikey : str
  API key for user</p>
<p><a id="dataverse_utils.dataverse_utils.force_notab_unlock"></a></p>
<h5 id="force_notab_unlock">force_notab_unlock<a class="headerlink" href="#force_notab_unlock" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def force_notab_unlock(study, dv_url, fid, apikey, try_uningest=True) -&gt; int
</code></pre>
<p>Forcibly unlocks and uningests
to prevent tabular file processing. Required if mime and filename
spoofing is not sufficient.</p>
<p>Returns 0 if unlocked, file id if locked (and then unlocked).</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>study : str
  Persistent indentifer of study</p>
<p>dv_url : str
  URL to base Dataverse installation</p>
<p>fid : str
  File ID for file object</p>
<p>apikey : str
  API key for user</p>
<p>try_uningest : bool
  Try to uningest the file that was locked.
- <code>Default</code> - True</p>
<p><a id="dataverse_utils.dataverse_utils.uningest_file"></a></p>
<h5 id="uningest_file">uningest_file<a class="headerlink" href="#uningest_file" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def uningest_file(dv_url, fid, apikey, study='n/a')
</code></pre>
<p>Tries to uningest a file that has been ingested.
Requires superuser API key.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>dv_url : str
  URL to base Dataverse installation</p>
<p>fid : int or str
  File ID of file to uningest</p>
<p>apikey : str
  API key for superuser</p>
<p>study : str
  Optional handle parameter for log messages</p>
<p><a id="dataverse_utils.dataverse_utils.upload_file"></a></p>
<h5 id="upload_file">upload_file<a class="headerlink" href="#upload_file" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def upload_file(fpath, hdl, **kwargs)
</code></pre>
<p>Uploads file to Dataverse study and sets file metadata and tags.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>fpath : str
  file location (ie, complete path)</p>
<p>hdl : str
  Dataverse persistent ID for study (handle or DOI)</p>
<p>kwargs : dict</p>
<p>other parameters. Acceptable keywords and contents are:</p>
<p>dv : str
  REQUIRED
  url to base Dataverse installation
- <code>eg</code> - &lsquo;https://abacus.library.ubc.ca&rsquo;</p>
<p>apikey : str
  REQUIRED
  API key for user</p>
<p>descr : str
  OPTIONAL
  file description</p>
<p>md5 : str
  OPTIONAL
  md5sum for file checking</p>
<p>tags : list
  OPTIONAL
  list of text file tags. Eg [&lsquo;Data&rsquo;, &lsquo;June 2020&rsquo;]</p>
<p>dirlabel : str
  OPTIONAL
  Unix style relative pathname for Dataverse
  file path: eg: path/to/file/</p>
<p>nowait : bool
  OPTIONAL
  Force a file unlock and uningest instead of waiting for processing
  to finish</p>
<p>trunc : str
  OPTIONAL
  Leftmost portion of path to remove</p>
<p>rest : bool
  OPTIONAL
  Restrict file. Defaults to false unless True supplied</p>
<p>mimetype : str
  OPTIONAL
  Mimetype of file. Useful if using File Previewers. Mimetype for zip files
  (application/zip) will be ignored to circumvent Dataverse&rsquo;s automatic
  unzipping function.
  label : str
  OPTIONAL
  If included in kwargs, this value will be used for the label
  timeout = int
  OPTIONAL
  Timeout in seconds</p>
<p><a id="dataverse_utils.dataverse_utils.restrict_file"></a></p>
<h5 id="restrict_file">restrict_file<a class="headerlink" href="#restrict_file" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def restrict_file(**kwargs)
</code></pre>
<p>Restrict file in Dataverse study.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>kwargs : dict</p>
<p>other parameters. Acceptable keywords and contents are:</p>
<p><strong>One of pid or fid is required</strong>
  pid : str
  file persistent ID</p>
<p>fid : str
  file database ID</p>
<p>dv : str
  REQUIRED
  url to base Dataverse installation
- <code>eg</code> - &lsquo;https://abacus.library.ubc.ca&rsquo;</p>
<p>apikey : str
  REQUIRED
  API key for user</p>
<p>rest : bool
  On True, restrict. Default True</p>
<p><a id="dataverse_utils.dataverse_utils.upload_from_tsv"></a></p>
<h5 id="upload_from_tsv">upload_from_tsv<a class="headerlink" href="#upload_from_tsv" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def upload_from_tsv(fil, hdl, **kwargs)
</code></pre>
<p>Utility for bulk uploading. Assumes fil is formatted
as tsv with headers &lsquo;file&rsquo;, &lsquo;description&rsquo;, &lsquo;tags&rsquo;.</p>
<p>&lsquo;tags&rsquo; field will be split on commas.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>fil : filelike object
  Open file object or io.IOStream()</p>
<p>hdl : str
  Dataverse persistent ID for study (handle or DOI)</p>
<p>trunc : str
  Leftmost portion of Dataverse study file path to remove.
- <code>eg</code> - trunc =&rsquo;/home/user/&rsquo; if the tsv field is
  &lsquo;/home/user/Data/ASCII&rsquo;
  would set the path for that line of the tsv to &lsquo;Data/ASCII&rsquo;.
  Defaults to None.</p>
<p>kwargs : dict</p>
<p>other parameters. Acceptable keywords and contents are:</p>
<p>dv : str
  REQUIRED
  url to base Dataverse installation
- <code>eg</code> - &lsquo;https://abacus.library.ubc.ca&rsquo;</p>
<p>apikey : str
  REQUIRED
  API key for user</p>
<p>rest : bool
  On True, restrict access. Default False</p>
<p><a id="dataverse_utils.ldc"></a></p>
<h2 id="dataverse_utilsldc">dataverse_utils.ldc<a class="headerlink" href="#dataverse_utilsldc" title="Permanent link">&para;</a></h2>
<p>Creates dataverse JSON from Linguistic Data Consortium
website page.</p>
<p><a id="dataverse_utils.ldc.Ldc"></a></p>
<h3 id="ldc-objects">Ldc Objects<a class="headerlink" href="#ldc-objects" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">class Ldc(ds.Serializer)
</code></pre>
<p>An LDC item (eg, LDC2021T01)</p>
<p><a id="dataverse_utils.ldc.Ldc.__init__"></a></p>
<h5 id="__init__">__init__<a class="headerlink" href="#__init__" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def __init__(ldc, cert=None)
</code></pre>
<p>Returns a dict with keys created from an LDC catalogue web
page.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>ldc : str
  Linguistic Consortium Catalogue Number (eg. &lsquo;LDC2015T05&rsquo;.
  This is what forms the last part of the LDC catalogue URL.
  cert : str
  Path to certificate chain; LDC has had a problem
  with intermediate certificates, so you can
  download the chain with a browser and supply a
  path to the .pem with this parameter</p>
<p><a id="dataverse_utils.ldc.Ldc.ldcJson"></a></p>
<h5 id="ldcjson">ldcJson<a class="headerlink" href="#ldcjson" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@property
def ldcJson()
</code></pre>
<p>Returns a JSON based on the LDC web page scraping</p>
<p><a id="dataverse_utils.ldc.Ldc.dryadJson"></a></p>
<h5 id="dryadjson">dryadJson<a class="headerlink" href="#dryadjson" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@property
def dryadJson()
</code></pre>
<p>LDC metadata in Dryad JSON format</p>
<p><a id="dataverse_utils.ldc.Ldc.dvJson"></a></p>
<h5 id="dvjson">dvJson<a class="headerlink" href="#dvjson" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@property
def dvJson()
</code></pre>
<p>LDC metadata in Dataverse JSON format</p>
<p><a id="dataverse_utils.ldc.Ldc.embargo"></a></p>
<h5 id="embargo">embargo<a class="headerlink" href="#embargo" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@property
def embargo()
</code></pre>
<p>Boolean indicating embargo status</p>
<p><a id="dataverse_utils.ldc.Ldc.fileJson"></a></p>
<h5 id="filejson">fileJson<a class="headerlink" href="#filejson" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@property
def fileJson(timeout=45)
</code></pre>
<p>Returns False: No attached files possible at LDC</p>
<p><a id="dataverse_utils.ldc.Ldc.files"></a></p>
<h5 id="files">files<a class="headerlink" href="#files" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@property
def files()
</code></pre>
<p>Returns None. No files possible</p>
<p><a id="dataverse_utils.ldc.Ldc.fetch_record"></a></p>
<h5 id="fetch_record">fetch_record<a class="headerlink" href="#fetch_record" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def fetch_record(url=None, timeout=45)
</code></pre>
<p>Downloads record from LDC website</p>
<p><a id="dataverse_utils.ldc.Ldc.make_ldc_json"></a></p>
<h5 id="make_ldc_json">make_ldc_json<a class="headerlink" href="#make_ldc_json" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def make_ldc_json()
</code></pre>
<p>Returns a dict with keys created from an LDC catalogue web
page.</p>
<p><a id="dataverse_utils.ldc.Ldc.name_parser"></a></p>
<h5 id="name_parser">name_parser<a class="headerlink" href="#name_parser" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@staticmethod
def name_parser(name)
</code></pre>
<p>Returns lastName/firstName JSON snippet from name</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>name : str
  A name</p>
<p><a id="dataverse_utils.ldc.Ldc.make_dryad_json"></a></p>
<h5 id="make_dryad_json">make_dryad_json<a class="headerlink" href="#make_dryad_json" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def make_dryad_json(ldc=None)
</code></pre>
<p>Creates a Dryad-style dict from an LDC dictionary</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>ldc : dict
  Dictionary containing LDC data. Defaults to self.ldcJson</p>
<p><a id="dataverse_utils.ldc.Ldc.find_block_index"></a></p>
<h5 id="find_block_index">find_block_index<a class="headerlink" href="#find_block_index" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">@staticmethod
def find_block_index(dvjson, key)
</code></pre>
<p>Finds the index number of an item in Dataverse&rsquo;s idiotic JSON list</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>dvjson : dict
  Dataverse JSON</p>
<p>key : str
  key for which to find list index</p>
<p><a id="dataverse_utils.ldc.Ldc.make_dv_json"></a></p>
<h5 id="make_dv_json">make_dv_json<a class="headerlink" href="#make_dv_json" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def make_dv_json(ldc=None)
</code></pre>
<p>Returns complete Dataverse JSON</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>ldc : dict
  LDC dictionary. Defaults to self.ldcJson</p>
<p><a id="dataverse_utils.ldc.Ldc.upload_metadata"></a></p>
<h5 id="upload_metadata">upload_metadata<a class="headerlink" href="#upload_metadata" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def upload_metadata(**kwargs) -&gt; dict
</code></pre>
<p>Uploads metadata to dataverse</p>
<p>Returns json from connection attempt.</p>
<hr />
<p><strong>Arguments</strong>:</p>
<p>kwargs:</p>
<p>url : str
  base url to Dataverse</p>
<p>key : str
  api key</p>
<p>dv : str
  Dataverse to which it is being uploaded</p>
<p><a id="dataverse_utils.dvdata"></a></p>
<h2 id="dataverse_utilsdvdata">dataverse_utils.dvdata<a class="headerlink" href="#dataverse_utilsdvdata" title="Permanent link">&para;</a></h2>
<p>Dataverse studies and files</p>
<p><a id="dataverse_utils.dvdata.Study"></a></p>
<h3 id="study-objects">Study Objects<a class="headerlink" href="#study-objects" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">class Study(dict)
</code></pre>
<p>Dataverse record. Dataverse study records are pure metadata so this
is represented with a dictionary.</p>
<p><a id="dataverse_utils.dvdata.Study.__init__"></a></p>
<h5 id="__init___1">__init__<a class="headerlink" href="#__init___1" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def __init__(pid: str, url: str, key: str, **kwargs)
</code></pre>
<p>pid : str
    Record persistent identifier: hdl or doi
url : str
    Base URL to host Dataverse instance
key : str
    Dataverse API key with downloader privileges</p>
<p><a id="dataverse_utils.dvdata.File"></a></p>
<h3 id="file-objects">File Objects<a class="headerlink" href="#file-objects" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">class File(dict)
</code></pre>
<p>Class representing a file on a Dataverse instance</p>
<p><a id="dataverse_utils.dvdata.File.__init__"></a></p>
<h5 id="__init___2">__init__<a class="headerlink" href="#__init___2" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def __init__(url: str, key: str, **kwargs)
</code></pre>
<p>url : str
    Base URL to host Dataverse instance
key : str
    Dataverse API key with downloader privileges
id : int or str
    File identifier; can be a file ID or PID
args : list
kwargs : dict</p>
<p>To initialize correctly, pass a value from Study[&lsquo;file_info&rsquo;].</p>
<p>Eg: File(&lsquo;https://test.invalid&rsquo;, &lsquo;ABC123&rsquo;, **Study_instance[&lsquo;file_info&rsquo;][0])</p>
<p><a id="dataverse_utils.dvdata.File.download_file"></a></p>
<h5 id="download_file">download_file<a class="headerlink" href="#download_file" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def download_file()
</code></pre>
<p>Downloads the file to a temporary location. Data will be in the ORIGINAL format,
not Dataverse-processed TSVs</p>
<p><a id="dataverse_utils.dvdata.File.del_tempfile"></a></p>
<h5 id="del_tempfile">del_tempfile<a class="headerlink" href="#del_tempfile" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def del_tempfile()
</code></pre>
<p>Delete tempfile if it exists</p>
<p><a id="dataverse_utils.dvdata.File.produce_digest"></a></p>
<h5 id="produce_digest">produce_digest<a class="headerlink" href="#produce_digest" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def produce_digest(prot: str = 'md5', blocksize: int = 2**16) -&gt; str
</code></pre>
<p>Returns hex digest for object</p>
<pre class="codehilite"><code>fname : str
   Path to a file object

prot : str
   Hash type. Supported hashes: 'sha1', 'sha224', 'sha256',
      'sha384', 'sha512', 'blake2b', 'blake2s', 'md5'.
      Default: 'md5'

blocksize : int
   Read block size in bytes
</code></pre>

<p><a id="dataverse_utils.dvdata.File.verify"></a></p>
<h5 id="verify">verify<a class="headerlink" href="#verify" title="Permanent link">&para;</a></h5>
<pre><code class="language-python">def verify() -&gt; None
</code></pre>
<p>Compares checksum with stated checksum</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../scripts/" class="btn btn-neutral float-left" title="Console utilities"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../faq/" class="btn btn-neutral float-right" title="FAQ">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../scripts/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../faq/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
